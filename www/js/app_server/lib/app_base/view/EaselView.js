(function(){define(["require","exports","module","backbone","app_base/controller/MediaController"],function(e,t,n){var r,i=e("backbone"),s=e("app_base/controller/MediaController"),o=Backbone.View.extend({el:"#mc",className:"easel-view",initialize:function(t){this.uid="app_easel_"+this.cid,r=window[this.uid]=this,r.manifest=t.manifest,t.type=="easel"&&e(["vendor/createjsModule"],function(){r.initEaselJs()}),t.type=="easel_iframe"&&r.initEaselJs()},initEaselJs:function(){var e=r.options;r.compId=r.options.compId,r.isTransparent=!0,e.transparent!=undefined&&(r.isTransparent=e.transparent),r.media=new s({preload_manifest:r.options.manifest,media_root:r.options.media_root,callback:r.onMediaReady})},onMediaReady:function(e){var t=r.options;t.type=="easel_iframe"?e.loadIframe(t.compId+".html",$(t.el),t.width,t.height,r.renderEaselIframe):e.loadEaselComp($(t.el),t.compId,r.renderEaselComposition,t.width,t.height)},renderEaselIframe:function(e,t){var n=$("#canvas",e).attr("width"),i=$("#canvas",e).attr("height");$("html,body,#canvas",e).css("margin",0).css("padding",0),r.isTransparent&&$("html,body,#canvas",e).css("background","transparent"),$("#canvas",e).css("margin-bottom","-6px"),$iframe=$("#"+t),$iframe.css("width",n).css("height",i),$iframe.attr("width",n),$iframe.attr("height",i);var s=window.document.getElementById(t).contentWindow,o=s.document.location.href,u=o.split("/")[o.split("/").length-1].replace(".html",""),a=setInterval(function(){s.exportRoot!=undefined&&(clearInterval(a),r.root=s.exportRoot.getChildAt(0),r.initDisplayObjects(r.root),r.onResize(),r.options.callback.call(null,u,r.root,n,i))},50)},renderEaselComposition:function(e,t,n,i){r.onResize(),r.root=t.getChildAt(0);var s=n,o=i;$canvas=$("#canvas_"+e),$canvas.attr("width",s).attr("height",o),$canvas.parent().attr("width",s).attr("height",o),$(r.el).attr("width",s).attr("height",o),r.initDisplayObjects(t),r.onResize(),r.options.callback.call(null,e,r.root,s,o)},initDisplayObjects:function(e){var t=[];for(var n in e.children)e.children[n].xHome=e.children[n].x,e.children[n].yHome=e.children[n].y,e.children[n].scaleXHome=e.children[n].scaleX,t.push(e.children[n].scaleYHome=e.children[n].scaleY);return t},declareInstances:function(e,t){var n,r,i;n=t,i=[];for(r in n)e[n[r]]!==undefined?(e[n[r]].name=n[r],e===this.root?i.push(this[n[r]]=e[n[r]]):i.push(void 0)):i.push(void 0);return i},onResize:function(e){r.sw=parseInt($(window).width()),r.sh=parseInt($(window).height())},destroy:function(){}});return n.exports=o})}).call(this);